# =============================================================================
# x402-rs Facilitator Configuration for Karmacadabra
# Ultravioleta DAO - Trustless Agent Economy
# =============================================================================
#
# SECURITY WARNING: This is an example file. NEVER commit actual .env files!
# Copy this to .env and fill in real values.
#
# Networks: Avalanche Fuji (testnet) + Avalanche Mainnet + Base Sepolia (testnet) + Base Mainnet + Celo (mainnet) + Celo Sepolia (testnet)
# Purpose: Payment facilitator for AI agent micropayments
# Deployment: Docker on AWS Fargate (facilitator.ultravioletadao.xyz)
#
# =============================================================================

# -----------------------------------------------------------------------------
# Network Configuration
# -----------------------------------------------------------------------------

# Signer type for transactions (private-key | keystore | ledger)
SIGNER_TYPE=private-key

# Hot wallet private key for gas payments (KEEP SECRET!)
# This wallet pays gas fees for all transferWithAuthorization() calls
# Recommended balance: 1-5 AVAX (enough for 100-500 transactions)
EVM_PRIVATE_KEY=0x0000000000000000000000000000000000000000000000000000000000000000

# Avalanche Fuji RPC endpoints
# Primary: Your custom/private RPC endpoint
RPC_URL_AVALANCHE_FUJI=https://avalanche-fuji-c-chain-rpc.publicnode.com

# Base Sepolia RPC endpoint (Chain ID: 84532)
RPC_URL_BASE_SEPOLIA=https://sepolia.base.org

# Base Mainnet RPC endpoint (Chain ID: 8453)
RPC_URL_BASE=https://mainnet.base.org

# Avalanche Mainnet RPC endpoint (Chain ID: 43114)
# Enables GLUE, USDC, WAVAX payments on Avalanche C-Chain mainnet
RPC_URL_AVALANCHE=https://avalanche-c-chain-rpc.publicnode.com

# Celo Mainnet RPC endpoint (Chain ID: 42220)
# Enables USDC payments on Celo mainnet
RPC_URL_CELO=https://rpc.celocolombia.org

# Celo Sepolia Testnet RPC endpoint (Chain ID: 44787)
# Enables USDC payments on Celo Sepolia testnet
RPC_URL_CELO_SEPOLIA=https://rpc.ankr.com/celo_sepolia

# -----------------------------------------------------------------------------
# Server Configuration
# -----------------------------------------------------------------------------

# Bind address (0.0.0.0 for Docker, 127.0.0.1 for local dev)
HOST=0.0.0.0

# Port for HTTP server
PORT=8080

# Rust logging level (trace | debug | info | warn | error)
RUST_LOG=info

# -----------------------------------------------------------------------------
# Token Addresses
# -----------------------------------------------------------------------------

# GLUE (UVD V2) Token on Avalanche Fuji (Primary payment token)
# Deployed address: 0x3D19A80b3bD5CC3a4E55D4b5B753bC36d6A44743
GLUE_TOKEN_ADDRESS_AVALANCHE_FUJI=0x3D19A80b3bD5CC3a4E55D4b5B753bC36d6A44743

# Legacy environment variable (for backwards compatibility)
GLUE_TOKEN_ADDRESS=0x3D19A80b3bD5CC3a4E55D4b5B753bC36d6A44743

# Note: GLUE is NOT deployed on Base Sepolia
# Base Sepolia uses USDC for payments (address below is auto-configured)

# USDC on Avalanche Fuji (Alternative payment token)
# Auto-configured in code, no need to set manually
USDC_FUJI_ADDRESS=0x5425890298aed601595a70AB815c96711a31Bc65

# WAVAX on Fuji (Wrapped AVAX, alternative payment token)
# Auto-configured in code, no need to set manually
WAVAX_FUJI_ADDRESS=0xd00ae08403B9bbb9124bB305C09058E32C39A48c

# USDC on Base Sepolia (Alternative payment token)
# Auto-configured in code: 0x036CbD53842c5426634e7929541eC2318f3dCF7e
# No need to set manually - facilitator knows this address

# -----------------------------------------------------------------------------
# Observability & Monitoring
# -----------------------------------------------------------------------------

# OpenTelemetry Configuration (Prometheus + Grafana + Loki)
# Exports traces, metrics, and logs to Grafana stack
OTEL_EXPORTER_OTLP_ENDPOINT=http://grafana.ultravioletadao.xyz:4317
OTEL_EXPORTER_OTLP_PROTOCOL=grpc
OTEL_SERVICE_NAME=x402-facilitator-karmacadabra
OTEL_SERVICE_VERSION=1.0.0

# Prometheus metrics endpoint (exposed at /metrics)
PROMETHEUS_ENABLED=true

# Log format (json | pretty)
LOG_FORMAT=json

# -----------------------------------------------------------------------------
# Security & Hot Wallet Management
# -----------------------------------------------------------------------------

# Minimum AVAX balance alert threshold (alert when below this)
BALANCE_ALERT_THRESHOLD=1.0

# Standby wallet address (for key rotation every 30 days)
STANDBY_WALLET_ADDRESS=0x0000000000000000000000000000000000000000

# -----------------------------------------------------------------------------
# Rate Limiting (Future Implementation)
# -----------------------------------------------------------------------------

# Enable rate limiting
RATE_LIMIT_ENABLED=false

# Requests per minute per IP
RATE_LIMIT_PER_MINUTE=60

# Requests per hour per IP
RATE_LIMIT_PER_HOUR=1000

# -----------------------------------------------------------------------------
# Webhooks (Future Implementation)
# -----------------------------------------------------------------------------

# Enable webhooks for payment events
WEBHOOKS_ENABLED=false

# Webhook URL for payment notifications
WEBHOOK_URL=https://api.ultravioletadao.xyz/webhooks/payments

# =============================================================================
# Deployment Checklist:
#
# Phase 1 - Initial Setup:
# ☐ Generate hot wallet and save private key to EVM_PRIVATE_KEY
# ☐ Fund hot wallet with 2-5 AVAX for Avalanche Fuji gas fees
# ☐ (Optional) Fund hot wallet with 0.5-1 ETH for Base Sepolia gas fees
# ☐ Deploy GLUE token to Avalanche Fuji (cd ../erc-20 && ./deploy-fuji.sh)
# ☐ Update GLUE_TOKEN_ADDRESS_AVALANCHE_FUJI with deployed address
# ☐ Set RPC_URL_AVALANCHE_FUJI (defaults to public RPC)
# ☐ (Optional) Set RPC_URL_BASE_SEPOLIA to enable USDC payments on Base
# ☐ Set OTEL_EXPORTER_OTLP_ENDPOINT to your Grafana instance
#
# Note: Base Sepolia and Celo support are OPTIONAL
# - If RPC_URL_BASE_SEPOLIA is set, facilitator will support USDC on Base Sepolia
# - If RPC_URL_CELO is set, facilitator will support USDC on Celo mainnet
# - If RPC_URL_CELO_SEPOLIA is set, facilitator will support USDC on Celo Sepolia testnet
# - GLUE token is NOT deployed on Base or Celo (only on Avalanche Fuji)
# - Base and Celo are useful for testing with other facilitators or USDC payments
#
# Phase 2 - Docker Deployment:
# ☐ Copy this file to .env and fill in real values
# ☐ Build Docker image: docker build -t x402-facilitator .
# ☐ Run container: docker run -d --env-file .env -p 8080:8080 x402-facilitator
# ☐ Test /health: curl https://facilitator.ultravioletadao.xyz/health
# ☐ Test /supported: curl https://facilitator.ultravioletadao.xyz/supported
#
# Phase 3 - Observability:
# ☐ Verify metrics at /metrics endpoint
# ☐ Check Grafana dashboard for facilitator metrics
# ☐ Setup alerts for balance < 1 AVAX
# ☐ Setup alerts for high error rate (>5%)
#
# Phase 4 - Production Hardening:
# ☐ Enable rate limiting (RATE_LIMIT_ENABLED=true)
# ☐ Setup key rotation procedure (30 days)
# ☐ Configure webhooks for payment events
# ☐ Load test with 100 req/min
#
# =============================================================================